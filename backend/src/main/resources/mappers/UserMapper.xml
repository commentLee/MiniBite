<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.minibite.user.repository.UserMapper">

    <resultMap id="UserResultMap" type="com.ssafy.minibite.user.domain.User">
        <id property="userId" column="user_id"/>
        <result property="password" column="password"/>
        <result property="nickname" column="nickname"/>
        <result property="phone" column="phone"/>
        <result property="height" column="height"/>
        <result property="weight" column="weight"/>
        <result property="gender" column="gender"/>
        <result property="age" column="age"/>
        <result property="personaType" column="persona_type"/>
        <result property="onboardingDate" column="onboarding_date"/>
        <result property="birthDate" column="birth_date"/>
    </resultMap>

    <insert id="insertUser">
        INSERT INTO user (
            user_id,
            password,
            nickname,
            phone,
            height,
            weight,
            gender,
            age,
            persona_type,
            onboarding_date,
            birth_date
        ) VALUES (
            #{userId},
            #{password},
            #{nickname},
            #{phone},
            #{height},
            #{weight},
            #{gender},
            #{age},
            #{personaType},
            #{onboardingDate},
            #{birthDate}
        )
    </insert>

    <select id="existsByUserId" parameterType="string" resultType="boolean">
        SELECT CASE WHEN COUNT(1) > 0 THEN TRUE ELSE FALSE END
        FROM user
        WHERE user_id = #{userId}
    </select>

    <select id="findByUserId" parameterType="string" resultMap="UserResultMap">
        SELECT
            user_id,
            password,
            nickname,
            phone,
            height,
            weight,
            gender,
            age,
            persona_type,
            onboarding_date,
            birth_date
        FROM user
        WHERE user_id = #{userId}
    </select>

</mapper>

